Alembic Database Migrations for ReadIn AI
==========================================

This directory contains Alembic database migrations for the ReadIn AI backend.

Quick Start
-----------

1. Install dependencies:
   pip install alembic

2. Run migrations:
   cd backend
   alembic upgrade head

3. Check current version:
   alembic current

Common Commands
---------------

# Apply all pending migrations
alembic upgrade head

# Revert one migration
alembic downgrade -1

# Revert all migrations
alembic downgrade base

# Show migration history
alembic history

# Show current database version
alembic current

# Generate a new migration (autogenerate from model changes)
alembic revision --autogenerate -m "Description of changes"

# Generate an empty migration
alembic revision -m "Description of changes"

# Show SQL that would be executed (without running)
alembic upgrade head --sql

Existing Database Setup
-----------------------

If you have an existing database with tables already created:

1. Mark the database as up-to-date without running migrations:
   alembic stamp head

This tells Alembic the database is at the current schema version.

Development vs Production
-------------------------

The configuration automatically detects DATABASE_URL from config.py:
- SQLite (development): Uses batch mode for ALTER TABLE support
- PostgreSQL (production): Uses standard operations

Migration Best Practices
------------------------

1. Always review autogenerated migrations before applying
2. Test migrations on a development database first
3. Back up production database before running migrations
4. Include both upgrade() and downgrade() functions
5. Use descriptive migration messages
6. Keep migrations small and focused

Files
-----

- env.py: Alembic environment configuration
- script.py.mako: Template for new migration files
- versions/: Directory containing migration scripts
